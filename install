
#   ┌───────────────────────────────┐
#   │                               │
#   │       Colors Variables        │
#   │                               │
#   └───────────────────────────────┘

COLOR_NC='\e[0m' # No Color
COLOR_BLACK='\e[0;30m'
COLOR_GRAY='\e[1;30m'
COLOR_RED='\e[0;31m'
COLOR_LIGHT_RED='\e[1;31m'
COLOR_GREEN='\e[0;32m'
COLOR_LIGHT_GREEN='\e[1;32m'
COLOR_BROWN='\e[0;33m'
COLOR_YELLOW='\e[1;33m'
COLOR_BLUE='\e[0;34m'
COLOR_LIGHT_BLUE='\e[1;34m'
COLOR_PURPLE='\e[0;35m'
COLOR_LIGHT_PURPLE='\e[1;35m'
COLOR_CYAN='\e[0;36m'
COLOR_LIGHT_CYAN='\e[1;36m'
COLOR_LIGHT_GRAY='\e[0;37m'
COLOR_WHITE='\e[1;37m'

#   ┌───────────────────────────────┐
#   │                               │
#   │       Program Variables       │
#   │                               │
#   └───────────────────────────────┘

repoconfigdir="$PWD/configs"
userconfigdir="$HOME/.config"

url_wallpaper_script="https://gist.githubusercontent.com/SergioRibera/e761fd61bc6a632c6b566c32aa25558a/raw/77c07702ede538e7736ff89ed71d43d3a9356086/wallpaper.sh"
url_packages_raw="https://gist.githubusercontent.com/SergioRibera/c30e826d7ada4a8385ac9b04a732bbb5/raw/0c01fd24313abe9faa4eabb3bf7190784ec522eb/packages"
packages=$(curl -s $url_packages_raw | tr "\n" " ")

set -e

install_rust() {
    sudo pacman -Sy rustup
    rustup default stable
    rustup target add wasm32-unknown-unknown
}

install_basic_packages() {
    echo -e "${COLOR_BLUE}Installing$COLOR_NC Paru"
    git clone https://aur.archlinux.org/paru-bin.git /tmp/paru
    (cd /tmp/paru && makepkg -si --clean --cleanbuild --noconfirm --needed) && rm -fr /tmp/paru
    echo -e "${COLOR_BLUE}Installing$COLOR_NC 'wget $packages'"
    paru --skipreview --cleanafter --noconfirm -Sy wget $packages

    echo -e "${COLOR_BLUE}Installing$COLOR_NC wallpaper script"
    sudo wget -O /usr/bin/wallpaper $url_wallpaper_script
    sudo chmod +x /usr/bin/wallpaper
}

link_nvim_configs() {
    git clone --depth 1 https://github.com/SergioRibera/NvimDotFiles ~/Repos/NvimDotFiles
    ln -s "$HOME/Repos/NvimDotfiles" "$HOME/.config/nvim"
}

link_all_config() {
    mkdir -p ~/{.config,.cargo}
    for f in $repoconfigdir/*; do
        filename=$(basename $f)
        echo -e "${COLOR_PURPLE}Linking Config${COLOR_NC}: $filename"
        ln -s $f "$userconfigdir/$filename"
    done
    echo -e "${COLOR_PURPLE}Linking scripts${COLOR_NC}"
    ln -s "$PWD/scripts" "$HOME/.config/scripts"
    echo -e "${COLOR_PURPLE}Linking Git Config${COLOR_NC}"
    ln -s "$PWD/.gitconfig" "$HOME/.gitconfig"
    echo -e "${COLOR_PURPLE}Linking Rust Config${COLOR_NC}"
    ln -s "$PWD/.cargo/config" "$HOME/.cargo/config"
    ln -s "$PWD/.cargo/cargo-generate.toml" "$HOME/.cargo/cargo-generate.toml"
}

start_services() {
    services=(docker bluetooth gdm)
    for s in $servcices; do
        sudo systemctl enable $s
        sudo systemctl start $s
    done
}

# install_basic_packages
# install_rust
link_all_config
link_nvim_configs
# start_services
